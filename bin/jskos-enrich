#!/usr/bin/env -S node --no-deprecation

import program from "../lib/cli.js"
import enrich from "../lib/enrich-action.js"

program
  .usage("[options] [files...]")
  .option("-v, --verbose", "show detailed error messages")
  .example("input.ndjson output.ndjson ", "Enrich records with subject labels")

const args = program.parseArgs(process.argv)
const files = args.length ? args : ["-"]
const options = program.opts()

;(async () => {
  try {
    await enrich(files, options)
  } catch (err) {
    // if you want to show stack on verbose only:
    if (options.verbose) {
      console.error(err)
    } else {
      console.error(err.message || err)
    }
    process.exit(1)
  }
})()
